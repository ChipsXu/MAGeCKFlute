# MAGeCKFlute
Analyzing pooled CRISPR functional genetic screens with MAGeCKFlute

## Abstract
The purpose to do CRISPR screen is to filter essential genes, pathways and to explain the background mechanisms. We developed MAGeCKFlute to perform integrated analysis of CRISPR/Cas9 screens with/without drug treatments. The MAGeCKFlute provides several strategies to remove potential biases within read counts and beta scores. The downstream analysis for CBS and TBS with the package includes identifying essential, non- essential, and drug-associated genes, and performing biological functional analysis for these genes. The package also visualizes genes in the context of pathways to better help users explore the screening data. Collectively, MAGeCKFlute enables accurate identification of essential, non-essential, drug-targeted genes, as well as their related biological functions.

## Install package MAGeCKFlute

~~~
source("http://bioconductor.org/biocLite.R")
biocLite("MAGeCKFlute")
~~~

## Quick start
Here we show the most basic steps for an analysis pipeline of pooled
CRISPR functional genetic screens. There are a variety of steps
upstream of MAGeCKFlute that result in the generation of gene summary file, in which FDRs of positive and negative selection genes, or beta scores of genes in all conditions are available. 

To run MAGeCKFlute pipeline, we need gene summary data generated by
MAGeCK MLE or MAGeCK RRA. MAGeCKFlute package provides two example data, one is `BRAF_mle.gene_sunmmary` generated by running MAGeCK MLE, and the other is `BRAF_rra.gene_summary` obtained by performing MAGeCK RRA analysis. 

###Run pipeline from gene summary file generated by MAGeCK MLE  

~~~
library(MAGeCKFlute)##Load MLE gene summary data
data("BRAF_mle.gene_summary")
##Run the MAGeCKFlute MLE pipeline
FluteMLE(gene_summary=BRAF_mle.gene_summary, ctrlname=c("D7_R1", "D7_R2"), 
		treatname=c("PLX7_R1","PLX7_R2"), prefix="BRAF", organism="hsa")
~~~

All pipeline results are written into local directory `./BRAF_Flute_Results/`, and all figures are integrated into file
 `BRAF_Flute.mle_summary.pdf`.

###Run pipeline from MAGeCK RRA results

~~~##Load RRA gene summary
data("BRAF_rra.gene_summary")
##Run the MAGeCKFlute RRA pipeline
FluteRRA(BRAF_rra.gene_summary, prefix="BRAF", organism="hsa")
~~~

All pipeline results are written into local directory `./BRAF_Flute_Results/` too, and all figures are integrated into file  `BRAF_Flute.rra_summary.pdf`.

## Contacts

* Wubing Zhang (Watson5bZhang@gmail.com)
* Binbin Wang (wangbinbintj@gmail.com)
* Feizhen Wu
